
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>geo_py.rotations &#8212; geo_py 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/classic.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">geo_py 0.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">geo_py.rotations</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for geo_py.rotations</h1><div class="highlight"><pre>
<span></span><span class="c1"># Import necessary packages here</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">radians</span><span class="p">,</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">pi</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span>
<span class="c1"># ================================================================================</span>
<span class="c1"># ================================================================================</span>
<span class="c1"># File:    rotations.py</span>
<span class="c1"># Date:    January 14, 2023</span>
<span class="c1"># Purpose: Describe the purpose of functions of this file</span>

<span class="c1"># Source Code Metadata</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Jonathan A. Webb&quot;</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s2">&quot;Copyright 2023, Jon Webb Inc.&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;1.0&quot;</span>
<span class="c1"># ================================================================================</span>
<span class="c1"># ================================================================================</span>
<span class="c1"># DIRECTION COSINE FUNCTIONS</span>


<div class="viewcode-block" id="rotation_matrix"><a class="viewcode-back" href="../../Rotations.html#geo_py.rotations.rotation_matrix">[docs]</a><span class="k">def</span> <span class="nf">rotation_matrix</span><span class="p">(</span><span class="n">yaw</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">pitch</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">roll</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                    <span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ZYX&quot;</span><span class="p">,</span> <span class="n">deg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="n">extrinsic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param yaw: The rotation about the x-axis in units of degrees or radians.</span>
<span class="sd">                This axis is also known as the yaw axis.</span>
<span class="sd">    :param pitch: The rotation about the y-axis in units of degrees or radians.</span>
<span class="sd">                  This axis is also known as the pitch axis.</span>
<span class="sd">    :param roll: The rotation about the z-axis in units of degrees or radians.</span>
<span class="sd">                  This axis is also known as the roll axis.</span>
<span class="sd">    :param order: The order of rotation as a string.  Defaulted to &#39;ZYX&#39;, which</span>
<span class="sd">                  is the traditional order for aircraft rotations.</span>
<span class="sd">                  Currently this function only support &#39;XYZ&#39;, &#39;XZY&#39;, &#39;YXZ&#39;,</span>
<span class="sd">                  &#39;YZX&#39;, &#39;ZXY&#39;, and &#39;ZYX&#39;.</span>
<span class="sd">    :param deg: True if the angles x_rot, y_rot, and z_rot are in units of</span>
<span class="sd">                degrees, False for radians.  Defaulted to False</span>
<span class="sd">    :param extrinsic: True if the direction cosine matrix is to be calculated as</span>
<span class="sd">                      an extrinsic rotation matrix, False for an intrinsic</span>
<span class="sd">                      matrix.  Defaulted to False.</span>

<span class="sd">    This function will return a direction cosine matrix according to the Euler</span>
<span class="sd">    angles fed to the function.  This function solves and multiplies the</span>
<span class="sd">    following rotation matrices where :math:`\\theta`, :math:`\\phi`,</span>
<span class="sd">    and :math:`\\psi` corresponse to roll, pitch, and yaw rotations.</span>

<span class="sd">    .. math::</span>

<span class="sd">       \\begin{align}</span>
<span class="sd">           R_x =</span>
<span class="sd">           \\begin{bmatrix}</span>
<span class="sd">               1 &amp; 0 &amp; 0 \\\\</span>
<span class="sd">               0 &amp; cos\\left(\\theta\\right) &amp; sin\\left(\\theta\\right) \\\\</span>
<span class="sd">               0 &amp; -sin\\left(\\theta\\right) &amp; cos\\left(\\theta\\right) \\\\</span>
<span class="sd">           \\end{bmatrix} \\\\</span>
<span class="sd">           \\\\</span>
<span class="sd">           R_y =</span>
<span class="sd">           \\begin{bmatrix}</span>
<span class="sd">               cos\\left(\\phi\\right) &amp; 0 &amp; -sin\\left(\\phi\\right) \\\\</span>
<span class="sd">               0 &amp; 1 &amp; 0 \\\\</span>
<span class="sd">               sin\\left(\\phi\\right) &amp; 0 &amp; cos\\left(\\phi\\right)</span>
<span class="sd">           \\end{bmatrix} \\\\</span>
<span class="sd">           \\\\</span>
<span class="sd">           R_z =</span>
<span class="sd">           \\begin{bmatrix}</span>
<span class="sd">               cos\\left(\\psi\\right) &amp; sin\\left(\\psi\\right) &amp; 0 \\\\</span>
<span class="sd">               -sin\\left(\\psi\\right) &amp; cos\\left(\\psi\\right) &amp; 0 \\\\</span>
<span class="sd">               0 &amp; 0 &amp; 1 \\\\</span>
<span class="sd">           \\end{bmatrix}</span>
<span class="sd">       \\end{align}</span>

<span class="sd">    As an example, if you were conducting a rotation about &#39;XZY&#39;, the multiplication</span>
<span class="sd">    would occur as such to obtain the intrinsic matrix</span>

<span class="sd">    .. math::</span>

<span class="sd">        R_i = R_x\\left(\\theta\\right)R_z\\left(\\psi\\right)R_y\\left(\\phi\\right)</span>

<span class="sd">    The extrinsic matrix is determined by taking the transpose of the intrinstic</span>
<span class="sd">    matrix.</span>

<span class="sd">    .. math::</span>

<span class="sd">        R_t = R_i^T</span>

<span class="sd">    Code examples</span>

<span class="sd">    .. code-block::</span>

<span class="sd">        from geo_py.rotations import rotation_matrix</span>

<span class="sd">        pitch = 0.83  # radians</span>
<span class="sd">        roll = 0.21  # radians</span>
<span class="sd">        yaw = 1.18  # radians</span>

<span class="sd">        # rotate about the ZYX axis, wich is default to get intrinsic matrix</span>
<span class="sd">        dcm = rotation_matrix(yaw, pitch, roll)</span>
<span class="sd">        print(dcm)</span>
<span class="sd">        &gt;&gt;&gt; [[ 0.25707693, -0.84569594, 0.46766422],</span>
<span class="sd">             [0.62399419, 0.51478756, -0.58789882],</span>
<span class="sd">             [-0.73793137, 0.14068453, 0.66004936]]</span>

<span class="sd">    .. code-block::</span>

<span class="sd">        from geo_py.rotations import rotation_matrix</span>

<span class="sd">        # Find the extrinsic matrix with inputs in degrees, rotated against xyz</span>
<span class="sd">        pitch = 22.1  # degrees</span>
<span class="sd">        roll = 8.75  # degrees</span>
<span class="sd">        yaw = 12.8  # degrees</span>
<span class="sd">        dcm = rotation_matrix(ya, pitch, roll, order=&quot;XYZ&quot;, deg=True, extrinsic=True)</span>
<span class="sd">        print(dcm)</span>
<span class="sd">        &gt;&gt;&gt; [[ 0.90335038, -0.20527103, 0.37622426],</span>
<span class="sd">             [0.27478025, 0.95112031, -0.14094667],</span>
<span class="sd">             [-0.32890227, 0.23072485, 0.91574524]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">order</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">deg</span><span class="p">:</span>
        <span class="n">yaw</span> <span class="o">=</span> <span class="n">radians</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span>
        <span class="n">pitch</span> <span class="o">=</span> <span class="n">radians</span><span class="p">(</span><span class="n">pitch</span><span class="p">)</span>
        <span class="n">roll</span> <span class="o">=</span> <span class="n">radians</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span>

    <span class="n">rot_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">roll</span><span class="p">)],</span>
                      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">roll</span><span class="p">)]])</span>
    <span class="n">rot_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">pitch</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">pitch</span><span class="p">)],</span>
                      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                      <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">pitch</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">pitch</span><span class="p">)]])</span>
    <span class="n">rot_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">yaw</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">yaw</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
                      <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">yaw</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">yaw</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span>
                      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

    <span class="c1"># Multiply rotation matrices according to the order of rotations</span>
    <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">&quot;XYZ&quot;</span><span class="p">:</span>
        <span class="n">rot_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">rot_x</span><span class="p">,</span> <span class="n">rot_y</span><span class="p">),</span> <span class="n">rot_z</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">&quot;XZY&quot;</span><span class="p">:</span>
        <span class="n">rot_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">rot_x</span><span class="p">,</span> <span class="n">rot_z</span><span class="p">),</span> <span class="n">rot_y</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">&quot;YXZ&quot;</span><span class="p">:</span>
        <span class="n">rot_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">rot_y</span><span class="p">,</span> <span class="n">rot_x</span><span class="p">),</span> <span class="n">rot_z</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">&quot;YZX&quot;</span><span class="p">:</span>
        <span class="n">rot_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">rot_y</span><span class="p">,</span> <span class="n">rot_z</span><span class="p">),</span> <span class="n">rot_x</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">&quot;ZXY&quot;</span><span class="p">:</span>
        <span class="n">rot_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">rot_z</span><span class="p">,</span> <span class="n">rot_x</span><span class="p">),</span> <span class="n">rot_y</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">&quot;ZYX&quot;</span><span class="p">:</span>
        <span class="n">rot_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">rot_z</span><span class="p">,</span> <span class="n">rot_y</span><span class="p">),</span> <span class="n">rot_x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid rotation order&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">extrinsic</span><span class="p">:</span>
        <span class="n">rot_final</span> <span class="o">=</span> <span class="n">rot_final</span><span class="o">.</span><span class="n">T</span>
    <span class="k">return</span> <span class="n">rot_final</span></div>
<span class="c1"># --------------------------------------------------------------------------------</span>


<div class="viewcode-block" id="dcm_euler_angles"><a class="viewcode-back" href="../../Rotations.html#geo_py.rotations.dcm_euler_angles">[docs]</a><span class="k">def</span> <span class="nf">dcm_euler_angles</span><span class="p">(</span><span class="n">dcm</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ZYX&quot;</span><span class="p">,</span> <span class="n">deg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                     <span class="n">extrinsic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param dcm: A direction cosine matrix of order 3x3</span>
<span class="sd">    :param order: The order of rotation as a string.  Defaulted to &#39;ZYX&#39;, which</span>
<span class="sd">                  is the traditional order for aircraft rotations.</span>
<span class="sd">                  Currently this function only support &#39;XYZ&#39;, &#39;XZY&#39;, &#39;YXZ&#39;,</span>
<span class="sd">                  &#39;YZX&#39;, &#39;ZXY&#39;, and &#39;ZYX&#39;.</span>
<span class="sd">    :param deg: True if the angles x_rot, y_rot, and z_rot are in units of</span>
<span class="sd">                degrees, False for radians.  Defaulted to False</span>
<span class="sd">    :param extrinsic: True if the direction cosine matrix is to be calculated as</span>
<span class="sd">                      an extrinsic rotation matrix, False for an intrinsic</span>
<span class="sd">                      matrix.  Defaulted to False.</span>

<span class="sd">    This function will determine hte Euler angles associated with a direction</span>
<span class="sd">    cosine matrix assuming knowledge of the rotation order.  Assuming,</span>
<span class="sd">    a rotation in the &#39;XYZ&#39; orientations, the Euler angles can be determined</span>
<span class="sd">    from the following formula where :math:`R_{x,y}` reprsents an attribute</span>
<span class="sd">    of the rotation matrix from postion :math:`x`, and :math:`y`.</span>

<span class="sd">    .. math::</span>

<span class="sd">        \\begin{align}</span>
<span class="sd">            \\alpha=arctan2\\left(\\frac{R_{32}}{R_{22}}\\right) \\\\</span>
<span class="sd">            \\beta=arcsin\\left(-R_{12}\\right) \\\\</span>
<span class="sd">            \\gamma=arctan2\\left(\\frac{R_{13}}{R_{11}}\\right)</span>
<span class="sd">        \\end{align}</span>

<span class="sd">    However, the exact nature of the equations change as a function of</span>
<span class="sd">    the orientation angle.  A further description of the applicable equations</span>
<span class="sd">    can be found here `rotations &lt;https://en.wikipedia.org/wiki/Euler_angles&gt;`_.</span>

<span class="sd">    Code Example</span>

<span class="sd">    .. code-block::</span>

<span class="sd">        from geo_py.rotations import rotation_matrix, dcm_euler_angles</span>

<span class="sd">        # Find the extrinsic matrix with inputs in degrees, rotated against xyz</span>
<span class="sd">        pitch = 22.1  # degrees</span>
<span class="sd">        roll = 8.75  # degrees</span>
<span class="sd">        yaw = 12.8  # degrees</span>
<span class="sd">        dcm = rotation_matrix(ya, pitch, roll, order=&quot;XYZ&quot;, deg=True,</span>
<span class="sd">                              extrinsic=False)</span>
<span class="sd">        yaw, pitch, roll = dcm_euler_angles(dcm, order=&quot;XYZ&quot;, deg=True)</span>
<span class="sd">        print(yaw, pitch, roll)</span>
<span class="sd">        &gt;&gt;&gt; 12.8, 22.1000,8.75</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">order</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">extrinsic</span><span class="p">:</span>
        <span class="n">dcm</span> <span class="o">=</span> <span class="n">dcm</span><span class="o">.</span><span class="n">T</span>
    <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;ZYX&#39;</span><span class="p">:</span>
        <span class="n">yaw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">dcm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dcm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">pitch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="o">-</span><span class="n">dcm</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">roll</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">dcm</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dcm</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;XYZ&#39;</span><span class="p">:</span>
        <span class="n">roll</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">-</span><span class="n">dcm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dcm</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="n">pitch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">dcm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="n">yaw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">-</span><span class="n">dcm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dcm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;XZY&#39;</span><span class="p">:</span>
        <span class="n">roll</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">dcm</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dcm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">pitch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">dcm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dcm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">yaw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="o">-</span><span class="n">dcm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;YXZ&#39;</span><span class="p">:</span>
        <span class="n">roll</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="o">-</span><span class="n">dcm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="n">pitch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">dcm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dcm</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="n">yaw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">dcm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dcm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;YZX&#39;</span><span class="p">:</span>
        <span class="n">roll</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">-</span><span class="n">dcm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dcm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">pitch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">-</span><span class="n">dcm</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dcm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">yaw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">dcm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;ZXY&#39;</span><span class="p">:</span>
        <span class="n">yaw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">-</span><span class="n">dcm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dcm</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">roll</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">dcm</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">pitch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="o">-</span><span class="n">dcm</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dcm</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid order of rotation.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">deg</span><span class="p">:</span>
        <span class="n">yaw</span> <span class="o">=</span> <span class="n">degrees</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span>
        <span class="n">pitch</span> <span class="o">=</span> <span class="n">degrees</span><span class="p">(</span><span class="n">pitch</span><span class="p">)</span>
        <span class="n">roll</span> <span class="o">=</span> <span class="n">degrees</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">yaw</span><span class="p">,</span> <span class="n">pitch</span><span class="p">,</span> <span class="n">roll</span></div>
<span class="c1"># --------------------------------------------------------------------------------</span>


<div class="viewcode-block" id="aircraft_rotation"><a class="viewcode-back" href="../../Rotations.html#geo_py.rotations.aircraft_rotation">[docs]</a><span class="k">def</span> <span class="nf">aircraft_rotation</span><span class="p">(</span><span class="n">yaw</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">pitch</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">roll</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                      <span class="n">deg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param yaw: The rotation about the yaw axis in units of degrees or radians</span>
<span class="sd">    :param pitch: The rotation about the pitch axis in units of degrees</span>
<span class="sd">                  or radians</span>
<span class="sd">    :param roll: The rotation about the roll axis in units of degrees</span>
<span class="sd">                 or radians.</span>
<span class="sd">    :param deg: True if units are in degrees, False for radians.</span>
<span class="sd">                Defaulted to false</span>
<span class="sd">    :return dcm: A direction cosine matrix rotated in the order ZYX</span>

<span class="sd">    This function returns the direction cosine matrix specifically rotated</span>
<span class="sd">    for an aircraft rotation about yaw, pitch and roll.  The rotation_matrix</span>
<span class="sd">    function can be used to accomplish the same utility as this function,</span>
<span class="sd">    however, no matrix multiplication is required with this function, which</span>
<span class="sd">    may reduce computational time if the function is called repetitively.</span>
<span class="sd">    This function implements the following rotation matrix, where</span>
<span class="sd">    :math:`\\theta`, :math:`\\phi`, and :math:`\\psi` represent</span>
<span class="sd">    pitch, roll, and yaw angles respectively</span>

<span class="sd">    .. math::</span>

<span class="sd">       C = \\\\</span>
<span class="sd">       \\begin{bmatrix}</span>
<span class="sd">           cos\\psi\\:cos\\theta &amp; cos\\psi\\:sin\\theta\\:sin\\phi-sin\\psi\\:cos\\phi &amp;</span>
<span class="sd">           cos\\psi\\:sin\\theta\\:cos\\phi+sin\\psi\\:sin\\phi \\\\</span>
<span class="sd">           sin\\psi\\:sin\\theta &amp; sin\\psi\\:sin\\theta\\:sin\\phi+cos\\psi\\:cos\\phi &amp;</span>
<span class="sd">           sin\\psi\\:sin\\theta\\:cos\\phi-cos\\psi\\:sin\\phi \\\\</span>
<span class="sd">           -sin\\theta &amp; cos\\theta\\:sin\\phi &amp; cos\\theta\\:cos\\phi</span>
<span class="sd">       \\end{bmatrix}</span>

<span class="sd">    Code Example</span>

<span class="sd">    .. code-block::</span>

<span class="sd">        from geo_py.rotations import aircraft_rotations</span>

<span class="sd">        pitch = 15  # degrees</span>
<span class="sd">        roll = 8  # degrees</span>
<span class="sd">        yaw = 3.2  # degrees</span>
<span class="sd">        dcm = aircraft_rotation(yaw, pitch, roll, deg=True)</span>
<span class="sd">        print(dcm)</span>
<span class="sd">        &gt;&gt;&gt; [[0.9035038 -0.16315976 0.39630769]</span>
<span class="sd">             [0.20527103 0.97647987 -0.06596119]</span>
<span class="sd">             [-0.37622426 0.14094667 0.91574524]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">deg</span><span class="p">:</span>
        <span class="n">yaw</span> <span class="o">=</span> <span class="n">radians</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span>
        <span class="n">pitch</span> <span class="o">=</span> <span class="n">radians</span><span class="p">(</span><span class="n">pitch</span><span class="p">)</span>
        <span class="n">roll</span> <span class="o">=</span> <span class="n">radians</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span>

    <span class="n">body_local</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">cos</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">pitch</span><span class="p">),</span>
                            <span class="n">cos</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">pitch</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span>
                            <span class="n">cos</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">pitch</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">roll</span><span class="p">)],</span>
                           <span class="p">[</span><span class="n">sin</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">pitch</span><span class="p">),</span>
                            <span class="n">sin</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">pitch</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span>
                            <span class="n">sin</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">pitch</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">roll</span><span class="p">)],</span>
                           <span class="p">[</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">pitch</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">pitch</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span>
                            <span class="n">cos</span><span class="p">(</span><span class="n">pitch</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">roll</span><span class="p">)]])</span>
    <span class="k">return</span> <span class="n">body_local</span></div>
<span class="c1"># ================================================================================</span>
<span class="c1"># ================================================================================</span>
<span class="c1"># eof</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">geo_py 0.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">geo_py.rotations</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Jonathan A. Webb.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>